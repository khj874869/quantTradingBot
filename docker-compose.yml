services:
  db:
    image: timescale/timescaledb:latest-pg16
    environment:
      POSTGRES_PASSWORD: postgres
      POSTGRES_USER: postgres
      POSTGRES_DB: quantbot
    ports:
      - "5432:5432"
    volumes:
      - dbdata:/var/lib/postgresql/data

  bot:
    build: .
    depends_on:
      - db
    env_file:
      - .env
    volumes:
      - ./state:/app/state
      - ./logs:/app/logs
    # All bot params are driven by env vars (see .env.example)
    command: >
      python -m quantbot.main
      --mode ${BOT_MODE:-demo}
      --venue ${BOT_VENUE:-demo}
      --symbols ${BOT_SYMBOLS:-DEMOCOIN-KRW}
      --entry-tf ${BOT_ENTRY_TF:-15m}
      --poll-sec ${BOT_POLL_SEC:-30}
      --news-feeds "${BOT_NEWS_FEEDS:-}"
      --notional ${BOT_NOTIONAL:-100000}

volumes:
  dbdata:
