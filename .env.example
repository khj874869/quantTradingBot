# QuantBot 환경변수 예시 (.env.example)
# 1) 이 파일을 복사해서 같은 폴더에 .env 로 저장하세요.
# 2) 실제 키/시크릿을 채워 넣고, 최초에는 TRADING_ENABLED=false 로 테스트하세요.
# 3) API 키는 절대 Git/메신저/클라우드에 공유하지 마세요.

# --- 공통 ---
ENV=prod
LOG_LEVEL=INFO
TIMEZONE=Asia/Seoul

# 실매매 스위치(가장 중요): true 일 때만 실주문 전송
TRADING_ENABLED=false

# --- 글로벌 리스크(멀티봇) ---
# (비율) 1.0 = 제한 없음. 예: 0.6이면 "총 익스포저 <= equity*0.6" 으로 신규 진입 차단
MAX_ACCOUNT_EXPOSURE_FRAC=1.0
MAX_TOTAL_EXPOSURE_FRAC=1.0
# (절대값) 0이면 비활성. 예: USDT 기준 5000
MAX_ACCOUNT_NOTIONAL=0
MAX_TOTAL_NOTIONAL=0
GLOBAL_RISK_STATE_PATH=state/global_risk.json

# 기본 수수료/슬리피지 (bps = 1/10000)
DEFAULT_FEE_BPS=10
DEFAULT_SLIPPAGE_BPS=5

# --- 손절/트레일링(가격 기준) ---
STOP_LOSS_PCT=0.01
TRAILING_STOP_PCT=0.005

# --- 스캘핑 기본값 (strategy=scalp) ---
# 목표 순익(수수료/슬리피지 반영 후) 0.39% = 0.0039
SCALP_TP_NET_PCT=0.0039
SCALP_LEVERAGE=1.0
# 1분 거래대금/오더북 대금 필터 (0이면 미사용)
SCALP_MIN_1M_TRADE_VALUE=0
SCALP_MIN_ORDERBOOK_NOTIONAL=0
# 호가 불균형(0~1) 임계치
SCALP_IMBALANCE_THRESHOLD=0.15

# RSI 역추세 진입 조건
SCALP_RSI_LONG_TRIGGER=40
SCALP_RSI_SHORT_MIN=65
SCALP_RSI_SHORT_MAX=70
SCALP_USE_RSI_CROSS=true

# 체결(Flow) 기반 몰림 스코어 관련
SCALP_PRESSURE_WINDOW_SEC=15
SCALP_TRADE_PRESSURE_THRESHOLD=0.2
SCALP_FLOW_WINDOW_SEC=15
SCALP_MIN_FLOW_NOTIONAL_RATE=0
SCALP_MIN_FLOW_ACCEL=0
SCALP_LARGE_TRADE_MIN_NOTIONAL=0
SCALP_MIN_LARGE_TRADE_SHARE=0
SCALP_MIN_TRADE_COUNT=0

# (바이낸스 선물) 강제청산 스트림 사용
SCALP_USE_LIQUIDATION_STREAM=true
SCALP_LIQ_WINDOW_SEC=60
SCALP_LIQ_BUCKET_BPS=10

# (IOC) 지정가-즉시체결 → 미체결 잔량 시장가
SCALP_ENTRY_USE_IOC=true
SCALP_EXIT_USE_IOC=true
SCALP_IOC_PRICE_PAD_BPS=2
SCALP_IOC_MAX_CHASE_BPS=12

# 스프레드/변동성 필터 (스캘핑)
SCALP_MAX_SPREAD_BPS=8
SCALP_MAX_1M_RANGE_PCT=0.012
SCALP_MAX_1M_BODY_PCT=0.010

# 뉴스봉 락아웃(진입 차단)
SCALP_NEWS_SPIKE_TV_MULT=5
SCALP_NEWS_SPIKE_MOVE_PCT=0.007
SCALP_NEWS_COOLDOWN_SEC=300

# --- 쿨다운(진입 재시도 제어 / 자동 백오프) ---
# 반복 REJECTED/HTTP 에러로 주문이 계속 실패할 때, 무한 재시도/스팸을 막기 위한 장치입니다.
# (중요) 쿨다운은 '신규 진입'만 막고, 포지션 청산(손절/익절)은 절대 막지 않습니다.
SCALP_COOLDOWN_ENABLED=true
SCALP_COOLDOWN_AFTER_EXIT_FILL_SEC=2
SCALP_COOLDOWN_AFTER_ENTRY_FILL_SEC=0
SCALP_COOLDOWN_REJECT_BASE_SEC=10
SCALP_COOLDOWN_HTTP400_SEC=30
SCALP_COOLDOWN_HTTP401_SEC=600
SCALP_COOLDOWN_RATE_LIMIT_SEC=5
SCALP_COOLDOWN_INSUFFICIENT_MARGIN_SEC=180

# Cause-specific recommended cooldowns (used when the bot can infer the reason).
# These are base cooldowns before exponential backoff.
SCALP_COOLDOWN_MIN_NOTIONAL_SEC=300
SCALP_COOLDOWN_FILTER_FAIL_SEC=60
SCALP_COOLDOWN_PRECISION_SEC=60
SCALP_COOLDOWN_POSITION_SIDE_SEC=600
SCALP_COOLDOWN_REDUCE_ONLY_SEC=60
SCALP_COOLDOWN_TRIGGER_IMMEDIATE_SEC=20
SCALP_COOLDOWN_TIMESTAMP_SEC=10
SCALP_COOLDOWN_MAX_OPEN_ORDERS_SEC=120
SCALP_COOLDOWN_LIQUIDATION_SEC=600
SCALP_COOLDOWN_BACKOFF_MULT=2.0
SCALP_COOLDOWN_MAX_SEC=900
SCALP_COOLDOWN_FAIL_WINDOW_SEC=180

# --- Binance (Spot/USDT-M Futures) ---
BINANCE_API_KEY=
BINANCE_API_SECRET=
# 선물 모드(프로그램 내부에서 venue=binance_futures로 구분)
BINANCE_FUTURES=true
# 필요 시 엔드포인트 수정
BINANCE_BASE_URL=https://api.binance.com
BINANCE_FUTURES_BASE_URL=https://fapi.binance.com

# --- Upbit (현물) ---
UPBIT_ACCESS_KEY=
UPBIT_SECRET_KEY=

# --- Namoo Bridge (주식) ---
NAMOO_BRIDGE_URL=http://127.0.0.1:8080
NAMOO_ACCOUNT_NO=

# --- Kiwoom REST (주식) ---
KIWOOM_BASE_URL=https://api.kiwoom.com
KIWOOM_APPKEY=
KIWOOM_SECRETKEY=
KIWOOM_ACCOUNT_NO=

# --- KIS(한국투자) (선택) ---
KIS_BASE_URL=https://openapi.koreainvestment.com:9443
KIS_APP_KEY=
KIS_APP_SECRET=
KIS_ACCOUNT_NO=
KIS_PRODUCT_CODE=



# Scalping sizing
SCALP_ORDER_SIZING_MODE=equity_pct  # fixed|equity_pct
SCALP_TRADE_EQUITY_FRAC=0.2
SCALP_MIN_NOTIONAL_POLICY=auto       # skip|bump|auto
SCALP_MIN_NOTIONAL_BUFFER=1.02
SCALP_AUTO_BUMP_MAX_OVER_NOTIONAL_FRAC=0.25  # auto일 때: 의도 notional 대비 허용 bump 비율(25%)


# --- Auto remediation (best-effort self-healing after entry failures) ---
SCALP_AUTO_REMEDIATE_ENABLED=true
SCALP_AUTO_REMEDIATE_MAX_RETRIES=1
SCALP_AUTO_REMEDIATE_MARGIN_SHRINK=0.7
SCALP_AUTO_REMEDIATE_CANCEL_OWN_OPEN_ORDERS=true
SCALP_AUTO_REMEDIATE_CANCEL_AGE_SEC=60
SCALP_AUTO_REMEDIATE_DISABLE_ON_UNAUTHORIZED_SEC=3600
SCALP_AUTO_REMEDIATE_DISABLE_ON_LIQUIDATION_SEC=3600
SCALP_AUTO_REMEDIATE_DISABLE_ON_POSITION_SIDE_SEC=900
